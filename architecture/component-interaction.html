<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Component Interaction | Vocdoni</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="A decentralized self sovereign governance platform">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/assets/css/0.styles.b4782a24.css" as="style"><link rel="preload" href="/assets/js/app.003a3fab.js" as="script"><link rel="preload" href="/assets/js/2.d75a9e61.js" as="script"><link rel="preload" href="/assets/js/16.7848fcf4.js" as="script"><link rel="prefetch" href="/assets/js/10.7d736aa9.js"><link rel="prefetch" href="/assets/js/11.24f4b6a1.js"><link rel="prefetch" href="/assets/js/12.fbc7926a.js"><link rel="prefetch" href="/assets/js/13.1d48d867.js"><link rel="prefetch" href="/assets/js/14.f1695afd.js"><link rel="prefetch" href="/assets/js/15.fd5bd6ca.js"><link rel="prefetch" href="/assets/js/17.a09d0fce.js"><link rel="prefetch" href="/assets/js/18.2d6d7bd0.js"><link rel="prefetch" href="/assets/js/19.7ca86ba4.js"><link rel="prefetch" href="/assets/js/20.7610a2ee.js"><link rel="prefetch" href="/assets/js/21.a33e4585.js"><link rel="prefetch" href="/assets/js/22.cdbbe0cb.js"><link rel="prefetch" href="/assets/js/23.daf8da8a.js"><link rel="prefetch" href="/assets/js/24.33f4a899.js"><link rel="prefetch" href="/assets/js/25.ca7b1363.js"><link rel="prefetch" href="/assets/js/26.00dda6a7.js"><link rel="prefetch" href="/assets/js/27.9643f5df.js"><link rel="prefetch" href="/assets/js/28.95fc6467.js"><link rel="prefetch" href="/assets/js/29.6d11f8e1.js"><link rel="prefetch" href="/assets/js/3.87bd6438.js"><link rel="prefetch" href="/assets/js/30.5f4b8604.js"><link rel="prefetch" href="/assets/js/31.57338027.js"><link rel="prefetch" href="/assets/js/32.c6e6f766.js"><link rel="prefetch" href="/assets/js/33.ee83017b.js"><link rel="prefetch" href="/assets/js/34.9adc375a.js"><link rel="prefetch" href="/assets/js/35.5a5f7bb7.js"><link rel="prefetch" href="/assets/js/36.e2545582.js"><link rel="prefetch" href="/assets/js/37.0eb8cc70.js"><link rel="prefetch" href="/assets/js/38.84124562.js"><link rel="prefetch" href="/assets/js/39.bf4aa161.js"><link rel="prefetch" href="/assets/js/4.6ba5942f.js"><link rel="prefetch" href="/assets/js/40.11b0e7ee.js"><link rel="prefetch" href="/assets/js/41.e727669e.js"><link rel="prefetch" href="/assets/js/42.995b740c.js"><link rel="prefetch" href="/assets/js/43.6a147059.js"><link rel="prefetch" href="/assets/js/44.a2bf17a5.js"><link rel="prefetch" href="/assets/js/45.3ff1d0d1.js"><link rel="prefetch" href="/assets/js/46.c84ab2db.js"><link rel="prefetch" href="/assets/js/47.b5fc1bda.js"><link rel="prefetch" href="/assets/js/48.87932f25.js"><link rel="prefetch" href="/assets/js/49.1b5e3ca0.js"><link rel="prefetch" href="/assets/js/5.0c02ed2b.js"><link rel="prefetch" href="/assets/js/50.0c49f3da.js"><link rel="prefetch" href="/assets/js/51.05425652.js"><link rel="prefetch" href="/assets/js/52.51995a7a.js"><link rel="prefetch" href="/assets/js/53.cd441341.js"><link rel="prefetch" href="/assets/js/54.69d5ba43.js"><link rel="prefetch" href="/assets/js/55.496f36cc.js"><link rel="prefetch" href="/assets/js/56.f98a821f.js"><link rel="prefetch" href="/assets/js/57.bf2fdef7.js"><link rel="prefetch" href="/assets/js/58.f208592f.js"><link rel="prefetch" href="/assets/js/59.a1cf2460.js"><link rel="prefetch" href="/assets/js/6.75834963.js"><link rel="prefetch" href="/assets/js/60.59aefd15.js"><link rel="prefetch" href="/assets/js/7.0929d87c.js"><link rel="prefetch" href="/assets/js/8.66ffbfac.js"><link rel="prefetch" href="/assets/js/9.5e86fdd3.js">
    <link rel="stylesheet" href="/assets/css/0.styles.b4782a24.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Vocdoni</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/architecture/general.html" class="nav-link">
  Architecture
</a></div><div class="nav-item"><a href="https://blog.vocdoni.io/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Blog
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="/about-us/vision.html" class="nav-link">
  About us
</a></div><div class="nav-item"><a href="https://discord.gg/sQCxgYs" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Discord
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/architecture/general.html" class="nav-link">
  Architecture
</a></div><div class="nav-item"><a href="https://blog.vocdoni.io/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Blog
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="/about-us/vision.html" class="nav-link">
  About us
</a></div><div class="nav-item"><a href="https://discord.gg/sQCxgYs" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Discord
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><a href="/architecture/general" class="sidebar-heading clickable open"><span>Architecture</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/architecture/general.html" class="sidebar-link">Global Architecture</a></li><li><a href="/architecture/process-overview.html" class="sidebar-link">Process Overview</a></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/architecture/census/census-overview" class="sidebar-heading clickable"><span>The Census</span> <span class="arrow right"></span></a> <!----></section></li><li><a href="/architecture/components.html" class="sidebar-link">Component Overview</a></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/architecture/smart-contracts/entity-resolver" class="sidebar-heading clickable"><span>Smart Contracts</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/architecture/services/gateway" class="sidebar-heading clickable"><span>Services</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/architecture/data-schemes/entity-metadata" class="sidebar-heading clickable"><span>Data Schemes</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/architecture/protocol/json-api" class="sidebar-heading clickable"><span>Protocol</span> <span class="arrow right"></span></a> <!----></section></li><li><a href="/architecture/component-interaction.html" aria-current="page" class="active sidebar-link">Component Interaction</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/architecture/component-interaction.html#prior-to-voting" class="sidebar-link">Prior to voting</a></li><li class="sidebar-sub-header"><a href="/architecture/component-interaction.html#voting" class="sidebar-link">Voting</a></li><li class="sidebar-sub-header"><a href="/architecture/component-interaction.html#after-voting" class="sidebar-link">After voting</a></li></ul></li><li><a href="/architecture/libraries-tooling.html" class="sidebar-link">Libraries and Tooling</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/integration/overview" class="sidebar-heading clickable"><span>Integration</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/integration/overview.html" class="sidebar-link">Overview</a></li><li><a href="/integration/getting-started-local-vochain.html" class="sidebar-link">Getting started with a local instance</a></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/integration/vaas-api" class="sidebar-heading clickable"><span>Voting as a Service</span> <span class="arrow right"></span></a> <!----></section></li><li><a href="/integration/manual-integration.html" class="sidebar-link">Manual Integration</a></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/integration/census/general" class="sidebar-heading clickable"><span>Census</span> <span class="arrow right"></span></a> <!----></section></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/deployment/gateway" class="sidebar-heading clickable"><span>Deployment</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/deployment/gateway.html" class="sidebar-link">Gateway Deployment (stage)</a></li><li><a href="/deployment/miner.html" class="sidebar-link">Miner Deployment</a></li><li><a href="/deployment/oracle.html" class="sidebar-link">Oracle Deployment (stage)</a></li><li><a href="/deployment/custom-vochain.html" class="sidebar-link">Custom Vochain Deployment</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/about-us/vision" class="sidebar-heading clickable"><span>About</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/about-us/vision.html" class="sidebar-link">Vision</a></li><li><a href="/about-us/how-we-work.html" class="sidebar-link">How We Work</a></li><li><section class="sidebar-group is-sub-group depth-1"><a href="/about-us/development-guidelines" class="sidebar-heading clickable"><span>Development Guidelines</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/about-us/development-guidelines.html" class="sidebar-link">Development guidelines</a></li><li><a href="/about-us/repository-branching.html" class="sidebar-link">Repository and branching guidelines</a></li></ul></section></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="component-interaction"><a href="#component-interaction" class="header-anchor">#</a> Component Interaction</h1> <p>Traditional systems like APIs present simple scenarios, in which a centralized service define how data should be encoded. However, decentralized ecosystems like a distributed voting system need much stronger work on defining every interaction between any two peers on the network.</p> <ul><li><a href="#component-interaction">Component Interaction</a> <ul><li><a href="#prior-to-voting">Prior to voting</a> <ul><li><a href="#overview">Overview</a></li> <li><a href="#initial-gateway-discovery">Initial Gateway discovery</a></li> <li><a href="#set-entity-metadata">Set Entity metadata</a></li></ul></li> <li><a href="#voting">Voting</a> <ul><li><a href="#overview-1">Overview</a></li> <li><a href="#voting-process-creation">Voting process creation</a></li> <li><a href="#voting-process-retrieval">Voting process retrieval</a></li> <li><a href="#check-census-inclusion">Check census inclusion</a></li> <li><a href="#casting-a-vote">Casting a vote</a></li></ul></li> <li><a href="#after-voting">After voting</a> <ul><li><a href="#overview-2">Overview</a></li> <li><a href="#checking-a-vote-envelope">Checking a Vote Envelope</a></li> <li><a href="#closing-a-voting-process">Closing a Voting Process</a></li> <li><a href="#vote-scrutiny">Vote Scrutiny</a></li></ul></li></ul></li></ul> <hr> <h2 id="prior-to-voting"><a href="#prior-to-voting" class="header-anchor">#</a> Prior to voting</h2> <h3 id="overview"><a href="#overview" class="header-anchor">#</a> Overview</h3> <p>Before a voting process can take place, the following four general steps must occur:</p> <ol><li>Vocdoni deploys the <a href="https://github.com/vocdoni/dvote-solidity#contracts" target="_blank" rel="noopener noreferrer">smart contracts<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> to Ethereum</li> <li>The <strong>organizer</strong> registers an <a href="/architecture/smart-contracts/entity-resolver">Entity</a> to the blockchain
<ul><li>The metadata of the entity is pinned on IPFS</li> <li>The reference is declared on the ENS resolver of the entity</li></ul></li> <li>A public key is registered  for each user
<ul><li><em>Either</em>:
<ul><li>The <strong>voter</strong> creates a self-sovereign identity and registers to an organization with their public key</li> <li>The <strong>organizer</strong> keeps a list of registered public keys of eligible voters</li></ul></li> <li><em>Or</em>:
<ul><li>The <strong>organizer</strong> creates a spreadsheet containing private information of each eligible voter. Each voter's public key for a specific voting process is derived from their private information.</li></ul></li></ul></li> <li>The <strong>organizer</strong> published a census Merkle Tree containing all voters' public keys</li></ol> <h3 id="initial-gateway-discovery"><a href="#initial-gateway-discovery" class="header-anchor">#</a> Initial Gateway discovery</h3> <p>The client wants to get initial connectivity with the available gateways.</p> <ol><li>Using a well-known Ethereum Gateway, we query for an initial boot node on the ENS Resolver. The following is defined:
<ul><li>Well-known Ethereum blockchain gateways</li> <li>Entity Resolver contract address</li> <li>Vocdoni's Entity ID</li></ul></li> <li>From one of the boot nodes, we get a list of Gateways provided by Vocdoni</li></ol> <div class="spinner" style="background:rgb(66, 185, 131);" data-v-1bbcb91a></div><p>Eventually:</p> <ul><li>One of Vocdoni's Gateways is used to query the ENS resolver of a certain Entity</li></ul> <h3 id="set-entity-metadata"><a href="#set-entity-metadata" class="header-anchor">#</a> Set Entity metadata</h3> <p>An Entity starts existing at the moment it has certain metadata stored on the <a href="/architecture/smart-contracts/entity-resolver.html#entityresolver">Entity Resolver</a> smart contract.</p> <div class="spinner" style="background:rgb(66, 185, 131);" data-v-1bbcb91a></div><p><strong>Used schemas:</strong></p> <ul><li><a href="/architecture/data-schemes/entity-metadata">Entity metadata</a></li></ul> <hr> <h2 id="voting"><a href="#voting" class="header-anchor">#</a> Voting</h2> <h3 id="overview-2"><a href="#overview-2" class="header-anchor">#</a> Overview</h3> <p>The voting process as a whole is as follows:</p> <ol><li>The <strong>organizer</strong> creates a voting process
<ul><li>Select the voter census or voter csv to use</li> <li>Get the census Merkle Root</li> <li>Pin the Merkle Tree on IPFS or similar</li> <li>Pin the <a href="/architecture/data-schemes/process">Process Metadata</a> on IPFS</li> <li>Send a transaction to the process smart contract, including <a href="/architecture/protocol/data-origins.html#content-uri">Content URI</a>s pointing to the <a href="/architecture/data-schemes/process">Process Metadata</a> and the <a href="/architecture/census/census-overview.html">Census Merkle Tree</a>, along with the rest of parameters</li> <li>Update the list of voting processes on the <a href="/architecture/smart-contracts/entity-resolver.html#entity-resolver">ENS Resolver</a> contract for the entity</li></ul></li> <li>The <strong>voter</strong> fetches the active processes for an <strong>Entity</strong>, or is sent a link directly to a process
<ul><li>Read the description and review the voting options</li></ul></li> <li>The <strong>voter</strong> verifies that they belong in the census:
<ul><li><em>Either</em>:
<ul><li>Decrypt their self-managed key and check its inclusion in the census</li></ul></li> <li><em>Or</em>:
<ul><li>Enter their private information to the client, which generates their ephemeral key pair for this process, and check that key's inclusion in the census</li></ul></li></ul></li> <li>The <strong>voter</strong> casts a vote
<ul><li>The client generates a proof that the voter's key belongs in the census Merkle Tree</li> <li>The client computes the user's nullifier for the vote</li> <li>The client generates the <a href="/architecture/smart-contracts/process.html#vote-package-zk-snarks">Vote Package</a> with the election choices</li> <li><em>If the process is encrypted</em>:
<ul><li>The client fetches the encryption public keys from the <strong>Gateway</strong></li> <li>The client encrypts the <a href="/architecture/smart-contracts/process.html#vote-package-zk-snarks">Vote Package</a> with the public keys of the voting process</li></ul></li> <li><em>If the process is anonymous</em>:
<ul><li>The client fetches the proving and verification keys and then generates the <strong>Zero-Knowledge Proof</strong></li> <li>The ZK Proof proves that:
<ul><li>The voter knows a private key, whose public key belongs to the census</li> <li>The provided nullifier matches the current process ID and the user's private key
</li></ul></li></ul></li> <li>The client generates the <a href="/architecture/data-schemes/process.html#vote-envelope-zk-snarks">Vote Envelope</a> containing the Vote Package</li> <li>The client selects a <strong>Gateway</strong> among the available ones and submits the <a href="/architecture/data-schemes/process.html#vote-envelope-zk-snarks">Vote Envelope</a></li> <li>The <strong>Gateway</strong> submits the <a href="/architecture/data-schemes/process.html#vote-envelope-zk-snarks">Vote Envelope</a> to the mempool of the Vochain</li></ul></li> <li>A <strong>Vochain miner</strong> processes an incoming <a href="/architecture/data-schemes/process.html#vote-envelope">Vote Envelope</a> <ul><li>The <strong>Vochain miner</strong> checks that the current block is within the process start/end blocks</li> <li>The <strong>Vochain miner</strong> checks that the given nullifier has not been used before</li> <li><em>If the process is anonymous</em>:
<ul><li>The <strong>Vochain miner</strong> checks that the <strong>ZK Proof</strong> of the <a href="/architecture/data-schemes/process.html#vote-envelope">Vote Envelope</a> is valid</li></ul></li> <li><em>If the process is not anonymous</em>:
<ul><li>The <strong>Vochain miner</strong> checks that the <strong>Merkle Proof</strong> of the <a href="/architecture/data-schemes/process.html#vote-envelope">Vote Envelope</a> matches the vote signature and the Merkle root</li></ul></li> <li>The <strong>Vochain miner</strong> adds the <a href="/architecture/data-schemes/process.html#vote-envelope">Vote Envelope</a> to the next block</li></ul></li></ol> <h3 id="voting-process-creation"><a href="#voting-process-creation" class="header-anchor">#</a> Voting process creation</h3> <div class="spinner" style="background:rgb(66, 185, 131);" data-v-1bbcb91a></div><p><strong>Used schemas:</strong></p> <ul><li><a href="/architecture/data-schemes/process.html#process-metadata">Process Metadata</a></li> <li><a href="/architecture/services/census-service.html#addclaimbulk">Census Service addClaimBulk</a></li> <li><a href="/architecture/services/census-service.html#getroot">Census Service getRoot</a></li> <li><a href="/architecture/services/census-service.html#dump">Census Service dump</a></li></ul> <h3 id="voting-process-retrieval"><a href="#voting-process-retrieval" class="header-anchor">#</a> Voting process retrieval</h3> <p>A user wants to retrieve the voting processes of a given Entity</p> <div class="spinner" style="background:rgb(66, 185, 131);" data-v-1bbcb91a></div><p><strong>Used schemas:</strong></p> <ul><li><a href="/architecture/data-schemes/process.html#process-metadata">Process Metadata</a></li></ul> <h3 id="check-census-inclusion"><a href="#check-census-inclusion" class="header-anchor">#</a> Check census inclusion</h3> <p>A user wants to know whether he/she belongs in the census of a process or not.</p> <div class="spinner" style="background:rgb(66, 185, 131);" data-v-1bbcb91a></div><p><strong>Used schemas:</strong></p> <ul><li><a href="/architecture/services/census-service.html#generateproof">Census Service generateProof</a></li></ul> <p><strong>Notes:</strong></p> <ul><li><code>generateProof</code> may be replaced with a call to <code>hasClaim</code>, for efficiency</li> <li>The <code>censusId</code> and <code>censusMessagingURI</code> should have been fetched from the <a href="/architecture/smart-contracts/process">Process Metadata</a></li></ul> <h3 id="casting-a-vote"><a href="#casting-a-vote" class="header-anchor">#</a> Casting a vote</h3> <p>A user wants to submit a vote for a given governance process.</p> <div class="spinner" style="background:rgb(66, 185, 131);" data-v-1bbcb91a></div><p><strong>Used schemas:</strong></p> <ul><li><a href="/architecture/data-schemes/process.html#process-metadata">Process Metadata</a></li> <li><a href="/architecture/services/census-service.html#generateproof">Census Service generateProof</a></li> <li><a href="/architecture/smart-contracts/process.html#vote-package">Vote Package</a></li></ul> <p><strong>Notes:</strong></p> <ul><li>The Merkle Proof could be retrieved and stored beforehand</li></ul> <h2 id="after-voting"><a href="#after-voting" class="header-anchor">#</a> After voting</h2> <h3 id="overview-3"><a href="#overview-3" class="header-anchor">#</a> Overview</h3> <ul><li>The <strong>voter</strong> checks that their vote is registered
<ul><li>The client asks a <strong>Gateway</strong> for the envelope status of his/her nullifier</li></ul></li> <li>The process ends
<ul><li><em>Either the <strong>organizer</strong> ends the process</em>:
<ul><li>The <strong>organizer</strong> sends a transaction to the process contract and sets the state of the process as ended</li> <li>An oracle relays the transaction to the Vochain</li></ul></li> <li><em>Or the process end block is reached</em>:
<ul><li>An oracle sends a transaction to the Vochain to signal that a process has ended</li></ul></li> <li>Further envelope submissions are rejected</li> <li><em>On encrypted processes</em>:
<ul><li>Miners create a transaction revealing their private key for the process</li></ul></li></ul></li> <li>The <strong>indexer</strong> computes the results, as well as any third-party <strong>observer</strong> who wishes to do so
<ul><li>The <strong>indexer</strong> fetches the <a href="/architecture/data-schemes/process">Process Metadata</a> from the process contract and IPFS</li> <li><em>On encrypted processes</em>:
<ul><li>The <strong>indexer</strong> requests the encryption private keys from the <strong>Gateway</strong></li></ul></li> <li>The <strong>indexer</strong> fetches all the <a href="/architecture/data-schemes/process.html#vote-envelope">Vote Envelopes</a> registered for the process</li> <li><em>On encrypted processes</em>:
<ul><li>The <strong>indexer</strong> decrypts each <a href="/architecture/smart-contracts/process.html#vote-package-zk-snarks">Vote Package</a></li></ul></li> <li>The <strong>indexer</strong> checks their ZK Proofs or Merkle Proofs, the <a href="/architecture/smart-contracts/process.html#vote-package-zk-snarks">Vote Package</a> contents and the restrictions imposed by the process flags</li> <li>The <strong>indexer</strong> counts the number of appearances of every single vote value
<ul><li>Any vote value beyond the ones defined in the <a href="/architecture/data-schemes/process">Process Metadata</a> is discarded
&lt;!-- - The <strong>indexer</strong> and any third-party <strong>observers</strong> publish the vote results</li></ul></li> <li>The <strong>indexer</strong> computes a ZK Rollup, proving that the given results have been correctly computed from valid vote envelopes and that the results include the choices of <code>N</code> valid voter</li> <li>The <strong>observer</strong> submits a transaction to the process smart contract, including the results and the ZK Rollup proof of the computation results --&gt;</li></ul></li></ul> <h3 id="checking-a-vote-envelope"><a href="#checking-a-vote-envelope" class="header-anchor">#</a> Checking a Vote Envelope</h3> <p>A user wants to check the status of an envelope by its nullifier.</p> <div class="spinner" style="background:rgb(66, 185, 131);" data-v-1bbcb91a></div><h3 id="closing-a-voting-process"><a href="#closing-a-voting-process" class="header-anchor">#</a> Closing a Voting Process</h3> <div class="spinner" style="background:rgb(66, 185, 131);" data-v-1bbcb91a></div><h3 id="vote-scrutiny"><a href="#vote-scrutiny" class="header-anchor">#</a> Vote Scrutiny</h3> <p>Anyone with network access can compute the scrutiny of a given processId.
</p> <div class="spinner" style="background:rgb(66, 185, 131);" data-v-1bbcb91a></div><p><strong>Used schemas:</strong></p> <ul><li><a href="/architecture/data-schemes/process.html#process-metadata">Process Metadata</a></li> <li><a href="/architecture/smart-contracts/process.html#vote-package">Vote Package</a></li></ul></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">8/2/2021, 9:44:42 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/architecture/protocol/data-origins.html" class="prev">
        Data Origins
      </a></span> <span class="next"><a href="/architecture/libraries-tooling.html">
        Libraries and Tooling
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.003a3fab.js" defer></script><script src="/assets/js/2.d75a9e61.js" defer></script><script src="/assets/js/16.7848fcf4.js" defer></script>
  </body>
</html>
